<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>类别选择测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                类别选择测试
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="category_id" class="form-label">产品类别</label>
                        <select class="form-select" id="category_id" name="category_id">
                            <option value="">请选择类别</option>
                            <option value="1">笔记本电脑</option>
                            <option value="2">台式电脑</option>
                            <option value="3">服务器</option>
                            <option value="4">电脑主机</option>
                            <option value="5">打印机</option>
                        </select>
                    </div>
                </div>
                
                <!-- 电脑主机配置部分 -->
                <div id="computerConfig" style="display:none;">
                    <hr>
                    <h5>电脑主机配置</h5>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="cpu" class="form-label">CPU</label>
                            <select class="form-select cpu-select" name="cpu">
                                <option value="">请选择CPU</option>
                                <option value="12" data-price="2399" data-label="i7-8700k">intel i7-8700k (¥2399)</option>
                                <option value="22" data-price="3299" data-label="i7-12700KF">intel i7-12700KF (¥3299)</option>
                            </select>
                            <small class="text-muted">CPU价格: <span class="cpu-price">¥0.00</span></small>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="memory" class="form-label">内存</label>
                            <select class="form-select memory-select" name="memory">
                                <option value="">请选择内存</option>
                                <option value="1" data-price="499" data-label="8GB DDR4">8GB DDR4 (¥499)</option>
                                <option value="2" data-price="799" data-label="16GB DDR4">16GB DDR4 (¥799)</option>
                            </select>
                            <small class="text-muted">内存价格: <span class="memory-price">¥0.00</span></small>
                        </div>
                    </div>
                </div>
                
                <!-- 打印机配置部分 -->
                <div id="printerConfig" style="display:none;">
                    <hr>
                    <h5>打印机配置</h5>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="brand" class="form-label">品牌</label>
                            <input type="text" class="form-control" id="brand" name="brand">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="model" class="form-label">型号</label>
                            <input type="text" class="form-control" id="model" name="model">
                        </div>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-md-12">
                        <button type="button" class="btn btn-primary" id="testButton">测试选择</button>
                        <div class="alert alert-info mt-3">
                            <strong>当前选择：</strong> 
                            <span id="currentSelection">无</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const categorySelect = document.getElementById('category_id');
            const computerConfig = document.getElementById('computerConfig');
            const printerConfig = document.getElementById('printerConfig');
            const currentSelection = document.getElementById('currentSelection');
            const testButton = document.getElementById('testButton');
            const cpuSelect = document.querySelector('.cpu-select');
            const cpuPrice = document.querySelector('.cpu-price');
            
            // 监听类别变化
            categorySelect.addEventListener('change', function() {
                const categoryId = this.value;
                const selectedOption = this.options[this.selectedIndex];
                const categoryName = selectedOption.text.trim();
                
                // 添加调试信息
                console.log('类别变化触发');
                console.log('类别ID:', categoryId);
                console.log('类别名称:', categoryName);
                console.log('是否匹配电脑主机:', categoryName.includes('电脑主机'));
                console.log('是否匹配台式电脑:', categoryName.includes('台式电脑'));
                console.log('是否匹配打印机:', categoryName.includes('打印机'));
                
                // 更新显示
                currentSelection.textContent = categoryName;
                
                // 隐藏所有配置区域
                computerConfig.style.display = 'none';
                printerConfig.style.display = 'none';
                
                // 根据类别名称显示相应配置
                if (categoryName.includes('电脑主机') || categoryName.includes('台式电脑')) {
                    console.log('显示电脑主机配置');
                    computerConfig.style.display = 'block';
                } else if (categoryName.includes('打印机')) {
                    console.log('显示打印机配置');
                    printerConfig.style.display = 'block';
                } else {
                    console.log('隐藏所有配置');
                }
            });
            
            // 测试按钮
            testButton.addEventListener('click', function() {
                console.log('测试按钮点击');
                console.log('当前类别ID:', categorySelect.value);
                console.log('当前类别名称:', categorySelect.options[categorySelect.selectedIndex].text.trim());
                console.log('computerConfig显示状态:', computerConfig.style.display);
                console.log('printerConfig显示状态:', printerConfig.style.display);
            });
            
            // CPU价格计算
            cpuSelect.addEventListener('change', function() {
                if (this.value) {
                    const price = parseFloat(this.options[this.selectedIndex].dataset.price) || 0;
                    cpuPrice.textContent = '¥' + price.toFixed(2);
                } else {
                    cpuPrice.textContent = '¥0.00';
                }
            });
        });
    </script>
</body>
</html>